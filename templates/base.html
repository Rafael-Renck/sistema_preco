<!doctype html>
<html lang="pt-br" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}{% endblock %} · Murta PriceHealth</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

  <style>
    :root{
      --bg:#f1f2f5; --shell:#ede9df; --ink:#0f172a; --muted:#6b7280;
      --sidebar-bg:#1c2530; --sidebar-bg-2:#2a3440; --sidebar-ink:#cbd5e1; --sidebar-active:#0ea5e9;
      --brand:#0ea5e9; --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444; --accent:#3b82f6;
      --row-bg:#e7f3ff; --row-bg-alt:#eef7ff; --card:#fff; --border:#e5e7eb; --radius:14px;
    }
    html,body{height:100%}
    body{background:var(--bg); color:var(--ink)}

    /* Layout app */
    .app{display:grid; grid-template-columns:260px 1fr; min-height:100vh}
    .app-sidebar{background:linear-gradient(180deg,var(--sidebar-bg),var(--sidebar-bg-2)); color:var(--sidebar-ink); padding:18px 12px}
    .app-sidebar .brand{display:flex; align-items:center; gap:10px; padding:10px 8px; margin-bottom:10px; color:#fff; text-decoration:none; font-weight:600}
    .app-sidebar .brand img, .app-sidebar .brand .brand-logo{height:68px; width:auto; max-width:180px;}
    .side-group{margin:10px 0}
    .side-title{font-size:.9rem; text-transform:uppercase; letter-spacing:.08em; opacity:.8; padding:6px 10px}
    .side-item{display:flex; align-items:center; gap:10px; color:var(--sidebar-ink); padding:10px 12px; margin:4px 0; border-radius:10px; text-decoration:none}
    .side-item:hover{background:rgba(255,255,255,.06); color:#fff}
    .side-item.active{background:rgba(14,165,233,.18); color:#fff; border-left:3px solid var(--sidebar-active)}

    .app-main{display:flex; flex-direction:column; min-width:0}
    .topbar{background:var(--shell); border-bottom:1px solid #ddd; padding:10px 18px; display:flex; align-items:center; justify-content:flex-end; gap:12px}
    .avatar{width:38px; height:38px; border-radius:50%; background:#1f3c58; color:#fff; display:grid; place-items:center; font-weight:600}
    .content-wrap{background:var(--shell); padding:20px}
    .content{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px}

    .page-head{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px}
    .searchbar{display:flex; align-items:center; gap:8px; border:1px solid var(--border); background:#fff; padding:10px 12px; border-radius:12px; min-width:340px}
    .searchbar input{border:0; outline:0; width:100%}

    .tbl-wrap{background:#fff; border:1px solid var(--border); border-radius:var(--radius); overflow:hidden}
    table.table-clean thead th{background:#fff; position:sticky; top:0; z-index:1; border-bottom:1px solid var(--border); color:#475569; font-weight:600}
    table.table-clean tbody tr:nth-child(odd){background:var(--row-bg)}
    table.table-clean tbody tr:nth-child(even){background:var(--row-bg-alt)}
    table.table-clean td,table.table-clean th{padding:14px 16px; vertical-align:middle}

    .td-actions i{font-size:1.05rem}
    .act-sync{color:var(--ok)} .act-upload{color:var(--brand)} .act-view{color:#10b981} .act-edit{color:var(--warn)} .act-more{color:var(--accent)} .act-danger{color:var(--danger)}
    .muted{color:var(--muted)} .nowrap{white-space:nowrap}

    /* Wrapper para páginas sem chrome (login, etc.) */
    .auth-wrap{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: linear-gradient(135deg, #1A237E 0%, #00796B 100%);
      padding: 24px;
    }

    @media (max-width:1100px){
      .app{grid-template-columns:78px 1fr}
      .side-title{display:none}
      .side-item span{display:none}
      .searchbar{min-width:0; width:100%}
    }
  </style>
  {% block head %}{% endblock %}
</head>
<body>
  {% if hide_chrome %}
    <!-- Layout limpo (login, recuperação, etc.) -->
    <div class="auth-wrap">
      {% block content_auth %}{% endblock %}
    </div>
  {% else %}
    <div class="app">
      <!-- Sidebar -->
      <aside class="app-sidebar">
        <a class="brand" href="{{ url_for('dashboard') }}">
          <img class="brand-logo" src="{{ url_for('static', filename='logo-menu.png') }}" alt="Murta Consultoria"/>
        </a>

        {% set is_admin = (session_perfil == 'adm') %}
        <div class="side-group">
          <div class="side-title">{{ 'Gerencias' if is_admin else 'Menu' }}</div>
          <a class="side-item {% if request.endpoint=='dashboard' %}active{% endif %}" href="{{ url_for('dashboard') }}">
            <i class="bi bi-grid"></i><span>Painel</span>
          </a>
          <a class="side-item {% if request.endpoint=='consulta_comparar' %}active{% endif %}" href="{{ url_for('consulta_comparar') }}">
            <i class="bi bi-search"></i><span>Consulta &amp; Comparar</span>
          </a>
        </div>

        {% if is_admin %}
        <div class="side-group">
          <div class="side-title">Cadastros</div>
          <a class="side-item {% if request.endpoint=='gerenciar_operadoras' %}active{% endif %}" href="{{ url_for('gerenciar_operadoras') }}"><i class="bi bi-building"></i><span>Operadoras</span></a>
          <a class="side-item {% if request.endpoint=='gerenciar_tabelas' %}active{% endif %}" href="{{ url_for('gerenciar_tabelas') }}"><i class="bi bi-table"></i><span>Tabelas</span></a>
          <a class="side-item {% if request.endpoint=='gerenciar_usuarios' %}active{% endif %}" href="{{ url_for('gerenciar_usuarios') }}"><i class="bi bi-people"></i><span>Usuarios</span></a>          <a class="side-item {% if request.endpoint=='cbhpm_rules' or request.endpoint=='cbhpm_rules_new' or request.endpoint=='cbhpm_rules_edit' %}active{% endif %}" href="{{ url_for('cbhpm_rules') }}"><i class="bi bi-sliders"></i><span>Regras CBHPM</span></a>
        </div>
        {% endif %}

      </aside>

      <!-- Main -->
      <section class="app-main">
        <div class="topbar">
          <span class="fw-semibold">{{ session_nome or 'Usuário' }}</span>
          <div class="avatar">{{ (session_nome[:1] if session_nome) or 'U' }}</div>
          <a class="btn btn-sm btn-outline-danger" href="{{ url_for('logout') }}">
            <i class="bi bi-box-arrow-right me-1"></i> Sair
          </a>
        </div>

        <div class="content-wrap">
          <div class="page-head">
            <h5 class="mb-0">{% block page_title %}{% endblock %}</h5>
            <div class="searchbar">
              <i class="bi bi-search"></i>
              <input id="globalSearch" placeholder="BUSCAR POR NOME OU EMAIL" />
            </div>
          </div>

          <div class="content">
            {% block content %}{% endblock %}
          </div>
        </div>
      </section>
    </div>
  {% endif %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  {% block scripts %}{% endblock %}
</body>
</html>


