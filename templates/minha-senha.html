{% extends 'base.html' %}
{% block title %}Atualizar Senha{% endblock %}
{% block content %}
<div class="content-narrow">
  <div class="page-header">
    <h4 class="mb-0">Atualizar senha</h4>
  </div>

  {% if must_change %}
    <div class="alert alert-warning">
      Sua senha precisa ser atualizada antes de continuar utilizando o sistema.
    </div>
  {% endif %}
  {% if erro %}
    <div class="alert alert-danger">{{ erro }}</div>
  {% endif %}

  <form method="post" class="card p-3">
    <div class="row g-3">
      <div class="col-12 col-md-6">
        <label class="form-label" for="senha_atual">Senha atual</label>
        <div class="input-group">
          <input class="form-control" id="senha_atual" type="password" name="senha_atual" required autofocus>
          <button class="btn btn-outline-secondary" type="button" data-toggle-password data-target="#senha_atual" aria-label="Mostrar ou ocultar senha atual">
            <i class="bi bi-eye"></i>
          </button>
        </div>
      </div>
      <div class="col-12 col-md-6"></div>
      <div class="col-12 col-md-6">
        <label class="form-label" for="senha_nova">Nova senha</label>
        <div class="input-group">
          <input class="form-control" id="senha_nova" type="password" name="senha_nova" required>
          <button class="btn btn-outline-secondary" type="button" data-toggle-password data-target="#senha_nova" aria-label="Mostrar ou ocultar nova senha">
            <i class="bi bi-eye"></i>
          </button>
        </div>
        <div class="form-text mt-1">
          Utilize pelo menos {{ security_password_min_length }} caracteres com letras maiúsculas, minúsculas, números e símbolos. Evite reutilizar as últimas {{ security_password_history_size }} senhas.
        </div>
      </div>
      <div class="col-12 col-md-6">
        <label class="form-label" for="senha_confirmacao">Confirme a nova senha</label>
        <div class="input-group">
          <input class="form-control" id="senha_confirmacao" type="password" name="senha_confirmacao" required>
          <button class="btn btn-outline-secondary" type="button" data-toggle-password data-target="#senha_confirmacao" aria-label="Mostrar ou ocultar confirmação de senha">
            <i class="bi bi-eye"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="d-flex gap-2 mt-3">
      <button class="btn btn-primary" type="submit">Salvar nova senha</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('logout') }}">Sair</a>
    </div>
  </form>
</div>
{% endblock %}
